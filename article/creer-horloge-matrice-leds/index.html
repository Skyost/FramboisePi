<!doctype html>
<html data-n-head-ssr lang="fr" data-n-head="%7B%22lang%22:%7B%22ssr%22:%22fr%22%7D%7D">
  <head>
    <title>Créer une horloge avec une matrice de LEDs | Framboise Pi</title><meta data-n-head="ssr" charset="utf-8"><meta data-n-head="ssr" name="viewport" content="width=device-width,initial-scale=1"><meta data-n-head="ssr" data-hid="description" name="description" content="Blog consacré au Raspberry Pi. Au programme : des actualités, des tutoriels en français, des conseils, des projets, et bien plus pour exploiter le maximum de votre framboise !"><meta data-n-head="ssr" name="theme-color" content="#c51d4a"><meta data-n-head="ssr" property="og:title" content="Créer une horloge avec une matrice de LEDs"><meta data-n-head="ssr" property="og:description" content="Premier projet à voir le jour sur blog ! Nous allons voir ici comment créer une horloge abordable
qui se déclenche au toucher à l'aide d'un Raspberry Pi, d'un Touchpad et d'une matrice de LEDs."><meta data-n-head="ssr" property="og:type" content="website"><meta data-n-head="ssr" property="og:site_name" content="Framboise Pi"><meta data-n-head="ssr" property="og:url" content="https://framboise-pi.skyost.eu/article/creer-horloge-matrice-leds"><meta data-n-head="ssr" property="og:image" content="https://framboise-pi.skyost.eu/images/articles/creer-horloge-matrice-leds/preview.png"><meta data-n-head="ssr" property="og:locale" content="fr_FR"><meta data-n-head="ssr" name="twitter:card" content="summary_large_image"><meta data-n-head="ssr" name="twitter:title" content="Créer une horloge avec une matrice de LEDs"><meta data-n-head="ssr" name="twitter:description" content="Premier projet à voir le jour sur blog ! Nous allons voir ici comment créer une horloge abordable
qui se déclenche au toucher à l'aide d'un Raspberry Pi, d'un Touchpad et d'une matrice de LEDs."><meta data-n-head="ssr" name="twitter:site" content="@Skyost"><meta data-n-head="ssr" name="twitter:creator" content="@Skyost"><meta data-n-head="ssr" name="twitter:url" content="https://framboise-pi.skyost.eu/article/creer-horloge-matrice-leds"><meta data-n-head="ssr" name="twitter:image" content="https://framboise-pi.skyost.eu/images/articles/creer-horloge-matrice-leds/preview.png"><link data-n-head="ssr" rel="icon" type="image/x-icon" href="/favicon.ico"><link data-n-head="ssr" rel="alternate" type="application/rss+xml" href="/feed.xml" title="Flux RSS de Framboise Pi"><link data-n-head="ssr" data-hid="gf-prefetch" rel="dns-prefetch" href="https://fonts.gstatic.com/"><link data-n-head="ssr" data-hid="gf-preconnect" rel="preconnect" href="https://fonts.gstatic.com/" crossorigin=""><link data-n-head="ssr" data-hid="gf-preload" rel="preload" as="style" href="https://fonts.googleapis.com/css2?family=Montserrat&family=Raleway&display=swap"><link data-n-head="ssr" rel="canonical" href="/article/creer-horloge-matrice-leds"><script data-n-head="ssr" data-hid="gf-script">!function(){var e=document.createElement("link");e.rel="stylesheet",e.href="https://fonts.googleapis.com/css2?family=Montserrat&family=Raleway&display=swap",document.querySelector("head").appendChild(e)}()</script><noscript data-n-head="ssr" data-hid="gf-noscript"><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Montserrat&family=Raleway&display=swap"></noscript><link rel="preload" href="/_nuxt/af919af.js" as="script"><link rel="preload" href="/_nuxt/4b1a53f.js" as="script"><link rel="preload" href="/_nuxt/css/fb702ca.css" as="style"><link rel="preload" href="/_nuxt/0a2b4e8.js" as="script"><link rel="preload" href="/_nuxt/css/edba119.css" as="style"><link rel="preload" href="/_nuxt/f4f5e1e.js" as="script"><link rel="preload" href="/_nuxt/css/3af6dc8.css" as="style"><link rel="preload" href="/_nuxt/4d20806.js" as="script"><link rel="stylesheet" href="/_nuxt/css/fb702ca.css"><link rel="stylesheet" href="/_nuxt/css/edba119.css"><link rel="stylesheet" href="/_nuxt/css/3af6dc8.css"><link rel="preload" href="/_nuxt/static/1623191137/article/creer-horloge-matrice-leds/state.js" as="script"><link rel="preload" href="/_nuxt/static/1623191137/article/creer-horloge-matrice-leds/payload.js" as="script"><link rel="preload" href="/_nuxt/static/1623191137/manifest.js" as="script">
  </head>
  <body>
    <div data-server-rendered="true" id="__nuxt"><!----><div id="__layout"><div><nav data-fetch-key="data-v-7ac399df:0" class="navbar navbar-light navbar-expand-lg" data-v-7ac399df><a href="/" target="_self" class="navbar-brand nuxt-link-active" data-v-7ac399df><img src="/_nuxt/img/pi.107f3a7.svg" alt="Pi" class="logo" data-v-7ac399df></a> <button type="button" aria-label="Toggle navigation" class="navbar-toggler" data-v-7ac399df><span class="navbar-toggler-icon"></span></button> <div id="nav-collapse" class="navbar-collapse collapse" style="display:none" data-v-7ac399df><ul class="navbar-nav ml-auto" data-v-7ac399df><li class="nav-item" data-v-7ac399df><a href="/" target="_self" class="nav-link nuxt-link-active" data-v-7ac399df><svg viewBox="0 0 16 16" width="1em" height="1em" focusable="false" role="img" aria-label="pen" xmlns="http://www.w3.org/2000/svg" fill="currentColor" class="bi-pen b-icon bi" data-v-7ac399df><g data-v-7ac399df><path d="M13.498.795l.149-.149a1.207 1.207 0 1 1 1.707 1.708l-.149.148a1.5 1.5 0 0 1-.059 2.059L4.854 14.854a.5.5 0 0 1-.233.131l-4 1a.5.5 0 0 1-.606-.606l1-4a.5.5 0 0 1 .131-.232l9.642-9.642a.5.5 0 0 0-.642.056L6.854 4.854a.5.5 0 1 1-.708-.708L9.44.854A1.5 1.5 0 0 1 11.5.796a1.5 1.5 0 0 1 1.998-.001zm-.644.766a.5.5 0 0 0-.707 0L1.95 11.756l-.764 3.057 3.057-.764L14.44 3.854a.5.5 0 0 0 0-.708l-1.585-1.585z"/></g></svg> Articles
      </a></li> <li class="nav-item" data-v-7ac399df><a href="#" target="_self" class="nav-link"><svg viewBox="0 0 16 16" width="1em" height="1em" focusable="false" role="img" aria-label="search" xmlns="http://www.w3.org/2000/svg" fill="currentColor" class="bi-search b-icon bi"><g><path d="M11.742 10.344a6.5 6.5 0 1 0-1.397 1.398h-.001c.03.04.062.078.098.115l3.85 3.85a1 1 0 0 0 1.415-1.414l-3.85-3.85a1.007 1.007 0 0 0-.115-.1zM12 6.5a5.5 5.5 0 1 1-11 0 5.5 5.5 0 0 1 11 0z"/></g></svg> Rechercher
  <!----></a></li> <li class="nav-item b-nav-dropdown dropdown" data-v-7ac399df><a role="button" aria-haspopup="true" aria-expanded="false" href="#" target="_self" class="nav-link dropdown-toggle"><svg viewBox="0 0 16 16" width="1em" height="1em" focusable="false" role="img" aria-label="list ul" xmlns="http://www.w3.org/2000/svg" fill="currentColor" class="bi-list-ul b-icon bi" data-v-7ac399df><g data-v-7ac399df><path fill-rule="evenodd" d="M5 11.5a.5.5 0 0 1 .5-.5h9a.5.5 0 0 1 0 1h-9a.5.5 0 0 1-.5-.5zm0-4a.5.5 0 0 1 .5-.5h9a.5.5 0 0 1 0 1h-9a.5.5 0 0 1-.5-.5zm0-4a.5.5 0 0 1 .5-.5h9a.5.5 0 0 1 0 1h-9a.5.5 0 0 1-.5-.5zm-3 1a1 1 0 1 0 0-2 1 1 0 0 0 0 2zm0 4a1 1 0 1 0 0-2 1 1 0 0 0 0 2zm0 4a1 1 0 1 0 0-2 1 1 0 0 0 0 2z"/></g></svg> Catégories
        </a><ul tabindex="-1" class="dropdown-menu dropdown-menu-right"> <li role="presentation" data-v-7ac399df><a href="/categorie/annonces/" role="menuitem" target="_self" class="dropdown-item">
          annonces
        </a></li><li role="presentation" data-v-7ac399df><a href="/categorie/astuces/" role="menuitem" target="_self" class="dropdown-item">
          astuces
        </a></li><li role="presentation" data-v-7ac399df><a href="/categorie/news/" role="menuitem" target="_self" class="dropdown-item">
          news
        </a></li><li role="presentation" data-v-7ac399df><a href="/categorie/projets/" role="menuitem" target="_self" class="dropdown-item">
          projets
        </a></li><li role="presentation" data-v-7ac399df><a href="/categorie/tutoriels/" role="menuitem" target="_self" class="dropdown-item">
          tutoriels
        </a></li></ul></li> <li class="nav-item" data-v-7ac399df><a href="https://skyost.eu" target="_self" class="nav-link" data-v-7ac399df><svg viewBox="0 0 16 16" width="1em" height="1em" focusable="false" role="img" aria-label="question" xmlns="http://www.w3.org/2000/svg" fill="currentColor" class="bi-question b-icon bi" data-v-7ac399df><g data-v-7ac399df><path d="M5.255 5.786a.237.237 0 0 0 .241.247h.825c.138 0 .248-.113.266-.25.09-.656.54-1.134 1.342-1.134.686 0 1.314.343 1.314 1.168 0 .635-.374.927-.965 1.371-.673.489-1.206 1.06-1.168 1.987l.003.217a.25.25 0 0 0 .25.246h.811a.25.25 0 0 0 .25-.25v-.105c0-.718.273-.927 1.01-1.486.609-.463 1.244-.977 1.244-2.056 0-1.511-1.276-2.241-2.673-2.241-1.267 0-2.655.59-2.75 2.286zm1.557 5.763c0 .533.425.927 1.01.927.609 0 1.028-.394 1.028-.927 0-.552-.42-.94-1.029-.94-.584 0-1.009.388-1.009.94z"/></g></svg> À propos
      </a></li></ul></div></nav> <div class="container"><div data-fetch-key="0"><!----> <img src="/images/articles/creer-horloge-matrice-leds/preview.png" alt="Créer une horloge avec une matrice de LEDs" class="w-100 mt-5"> <header class="pt-5 pb-5" data-v-75ff8836><h1 class="title" data-v-75ff8836><span data-v-75ff8836>Créer une horloge avec une matrice de LEDs</span></h1> <span class="d-block text-muted tagline" data-v-75ff8836>
    Écrit par <a href="https://skyost.eu" data-v-75ff8836>Skyost</a> le 12/04/2021.
    <span data-v-75ff8836>
      Mis à jour le 08/06/2021.
    </span> <span data-v-75ff8836><br data-v-75ff8836>Posté dans
      <span data-v-75ff8836>
        les catégories :
      </span> <span data-v-75ff8836><q data-v-75ff8836><a href="/categorie/tutoriels/" class="text-capitalize">tutoriels</a></q><span data-v-75ff8836>, </span></span><span data-v-75ff8836><q data-v-75ff8836><a href="/categorie/projets/" class="text-capitalize">projets</a></q><span data-v-75ff8836>.</span></span></span></span></header> <article data-v-1da88450><div class="nuxt-content" data-v-1da88450 data-v-1da88450><p data-v-1da88450 data-v-1da88450><em data-v-1da88450 data-v-1da88450>Premier projet à voir le jour sur blog ! Nous allons voir ici comment créer une horloge abordable
qui se déclenche au toucher à l'aide d'un Raspberry Pi, d'un Touchpad et d'une matrice de LEDs.</em></p>

<iframe src="https://www.youtube.com/embed/VBNRIcA_Ppg" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen class="youtube-frame" data-v-0ff1b48e data-v-1da88450></iframe>
<h2 id="matériel-nécessaire" data-v-1da88450 data-v-1da88450>Matériel nécessaire<a href="#mat%C3%A9riel-n%C3%A9cessaire" aria-hidden="true" tabindex="-1" data-v-1da88450 data-v-1da88450><span class="anchor" data-v-1da88450 data-v-1da88450></span></a></h2>
<p data-v-1da88450 data-v-1da88450>Le projet est très accessible mais nécessite pas mal de matériel. Vous aurez besoin de :</p>
<ul data-v-1da88450 data-v-1da88450>
<li data-v-1da88450 data-v-1da88450>1 <strong data-v-1da88450 data-v-1da88450>Raspberry Pi Zero WH</strong> [<a href="https://amzn.to/2RvB484" rel="nofollow noopener noreferrer" target="_blank" data-v-1da88450 data-v-1da88450>Amazon</a>,
<a href="https://s.click.aliexpress.com/e/_A9UaSn" rel="nofollow noopener noreferrer" target="_blank" data-v-1da88450 data-v-1da88450>AliExpress</a>]
(n'importe quel Raspberry Pi muni de ports GPIO devrait suffire, mais cette solution me semble être la moins
chère).</li>
<li data-v-1da88450 data-v-1da88450>1 <strong data-v-1da88450 data-v-1da88450>Matrice de LEDs</strong> [<a href="https://amzn.to/3dTBa0U" rel="nofollow noopener noreferrer" target="_blank" data-v-1da88450 data-v-1da88450>Amazon</a>,
<a href="https://s.click.aliexpress.com/e/_9zTnPl" rel="nofollow noopener noreferrer" target="_blank" data-v-1da88450 data-v-1da88450>AliExpress</a>] (je vous conseille celle d'AZ-Delivery,
abordable et de bonne qualité).</li>
<li data-v-1da88450 data-v-1da88450>1 <strong data-v-1da88450 data-v-1da88450>Touchpad USB</strong> [<a href="https://amzn.to/3wRrQmQ" rel="nofollow noopener noreferrer" target="_blank" data-v-1da88450 data-v-1da88450>Amazon</a>,
<a href="https://fr.aliexpress.com/item/32981629578.html" rel="nofollow noopener noreferrer" target="_blank" data-v-1da88450 data-v-1da88450>AliExpress</a>] (cela a l'avantage d'être généralement moins couteux
que l'achat d'un détecteur de mouvements et de boutons).</li>
<li data-v-1da88450 data-v-1da88450>1 <strong data-v-1da88450 data-v-1da88450>Câble micro USB - USB OTG</strong> [<a href="https://amzn.to/3wP0QEr" rel="nofollow noopener noreferrer" target="_blank" data-v-1da88450 data-v-1da88450>Amazon</a>,
<a href="https://s.click.aliexpress.com/e/_ABy4z9" rel="nofollow noopener noreferrer" target="_blank" data-v-1da88450 data-v-1da88450>AliExpress</a>].</li>
<li data-v-1da88450 data-v-1da88450>1 <strong data-v-1da88450 data-v-1da88450>Chargeur secteur USB</strong>.</li>
<li data-v-1da88450 data-v-1da88450>1 <strong data-v-1da88450 data-v-1da88450>Câble d'alimentation USB - micro USB</strong>.</li>
<li data-v-1da88450 data-v-1da88450>1 <strong data-v-1da88450 data-v-1da88450>Micro SD</strong> (prévoyez minimum 8Go pour n'importe quel projet).</li>
<li data-v-1da88450 data-v-1da88450>1 <strong data-v-1da88450 data-v-1da88450>Adaptateur SD</strong>.</li>
</ul>
<p data-v-1da88450 data-v-1da88450>Tout cela pour un coût total d'environ 60€ (si vous ne possédez rien).</p>
<h2 id="effectuer-les-branchements" data-v-1da88450 data-v-1da88450>Effectuer les branchements<a href="#effectuer-les-branchements" aria-hidden="true" tabindex="-1" data-v-1da88450 data-v-1da88450><span class="anchor" data-v-1da88450 data-v-1da88450></span></a></h2>
<p data-v-1da88450 data-v-1da88450>On va effectuer les branchements à l'aide du tableau suivant :</p>















































<table data-v-1da88450 data-v-1da88450><thead data-v-1da88450 data-v-1da88450><tr data-v-1da88450 data-v-1da88450><th data-v-1da88450 data-v-1da88450>Pin Matrice</th><th data-v-1da88450 data-v-1da88450>Nom</th><th data-v-1da88450 data-v-1da88450>Signification</th><th data-v-1da88450 data-v-1da88450>Pin RPi</th><th data-v-1da88450 data-v-1da88450>Fonction</th></tr></thead><tbody data-v-1da88450 data-v-1da88450><tr data-v-1da88450 data-v-1da88450><td data-v-1da88450 data-v-1da88450>1</td><td data-v-1da88450 data-v-1da88450>VCC</td><td data-v-1da88450 data-v-1da88450>+5V Power</td><td data-v-1da88450 data-v-1da88450>2</td><td data-v-1da88450 data-v-1da88450>5V0</td></tr><tr data-v-1da88450 data-v-1da88450><td data-v-1da88450 data-v-1da88450>2</td><td data-v-1da88450 data-v-1da88450>GND</td><td data-v-1da88450 data-v-1da88450>Ground</td><td data-v-1da88450 data-v-1da88450>6</td><td data-v-1da88450 data-v-1da88450>GND</td></tr><tr data-v-1da88450 data-v-1da88450><td data-v-1da88450 data-v-1da88450>3</td><td data-v-1da88450 data-v-1da88450>DIN</td><td data-v-1da88450 data-v-1da88450>Data In</td><td data-v-1da88450 data-v-1da88450>19</td><td data-v-1da88450 data-v-1da88450>GPIO 10 (MOSI)</td></tr><tr data-v-1da88450 data-v-1da88450><td data-v-1da88450 data-v-1da88450>4</td><td data-v-1da88450 data-v-1da88450>CS</td><td data-v-1da88450 data-v-1da88450>Chip Select</td><td data-v-1da88450 data-v-1da88450>24</td><td data-v-1da88450 data-v-1da88450>GPIO 8 (SPI CE0)</td></tr><tr data-v-1da88450 data-v-1da88450><td data-v-1da88450 data-v-1da88450>5</td><td data-v-1da88450 data-v-1da88450>CLK</td><td data-v-1da88450 data-v-1da88450>Clock</td><td data-v-1da88450 data-v-1da88450>23</td><td data-v-1da88450 data-v-1da88450>GPIO 11 (SPI CLK)</td></tr></tbody></table>
<p data-v-1da88450 data-v-1da88450><a href="https://luma-led-matrix.readthedocs.io/en/latest/install.html#max7219-devices-spi" rel="nofollow noopener noreferrer" target="_blank" data-v-1da88450 data-v-1da88450>Source</a>.</p>
<p data-v-1da88450 data-v-1da88450>Chaque port de la matrice de LEDs doit être relié au port correspondant sur le Raspberry.
Voici la carte des ports GPIO sur les modèles les plus récents :</p>
<p data-v-1da88450 data-v-1da88450><img alt="Carte des ports GPIO" src="/images/articles/creer-horloge-matrice-leds/gpio-pinout.png" data-v-1da88450 data-v-1da88450></p>
<p data-v-1da88450 data-v-1da88450><a href="https://www.raspberrypi.org/documentation/usage/gpio/" rel="nofollow noopener noreferrer" target="_blank" data-v-1da88450 data-v-1da88450>Source</a>.</p>
<p data-v-1da88450 data-v-1da88450>Ce qui devrait vous donner quelque-chose comme ça :</p>
<p data-v-1da88450 data-v-1da88450><img alt="Branchements" src="/images/articles/creer-horloge-matrice-leds/branchements.png" data-v-1da88450 data-v-1da88450></p>
<p data-v-1da88450 data-v-1da88450>Branchez ensuite le touchpad à l'aide du câble micro USB - USB.</p>
<h2 id="mettre-en-place-le-script" data-v-1da88450 data-v-1da88450>Mettre en place le script<a href="#mettre-en-place-le-script" aria-hidden="true" tabindex="-1" data-v-1da88450 data-v-1da88450><span class="anchor" data-v-1da88450 data-v-1da88450></span></a></h2>
<p data-v-1da88450 data-v-1da88450>Insérez votre micro SD dans votre ordinateur et flashez Raspberry Pi OS dessus (un tutoriel a été rédigé à ce sujet,
il est disponible <a href="/article/installation-minimale-raspberry-pi#t%C3%A9l%C3%A9charger-et-flasher-raspberry-os" data-v-1da88450>ici</a>). Activez SSH
et la connexion à votre réseau Wi-Fi en suivant les étapes disponibles
<a href="/article/installation-minimale-raspberry-pi#activer-ssh-et-se-connecter-au-wi-fi" data-v-1da88450>ici</a>.
Enlevez votre carte de l'ordinateur, et insérez-la dans le Raspberry que vous pouvez désormais mettre sous tension.</p>
<p data-v-1da88450 data-v-1da88450>Commencez par vous <a href="/article/installation-minimale-raspberry-pi/#se-connecter-en-ssh" data-v-1da88450>connecter en SSH</a>.
On va activer l'interface SPI en lançant l'utilitaire <code data-v-1da88450 data-v-1da88450>raspi-config</code> (il suffit pour cela d'exécuter la
commande <code data-v-1da88450 data-v-1da88450>sudo raspi-config</code>). Sélectionnez <em data-v-1da88450 data-v-1da88450>Interfacing Options</em>, puis <em data-v-1da88450 data-v-1da88450>SPI</em>, et <em data-v-1da88450 data-v-1da88450>Yes</em>.
Tant qu'on y est, on va changer le fuseau horaire de votre Pi. Pour ce faire, sortez de ce menu et rendez-vous dans
le menu <em data-v-1da88450 data-v-1da88450>Localisation Options</em>. À partir de ce menu, sélectionnez <em data-v-1da88450 data-v-1da88450>Change Timezone</em> et choisissez <em data-v-1da88450 data-v-1da88450>Europe (Paris)</em>.</p>
<p data-v-1da88450 data-v-1da88450>Sortez de l'utilitaire et  redémarrez (si <code data-v-1da88450 data-v-1da88450>raspi-config</code> ne vous propose pas de redémarrer,
la commande <code data-v-1da88450 data-v-1da88450>sudo reboot now</code> fera l'affaire).</p>
<p data-v-1da88450 data-v-1da88450>J'ai créé un petit script Python pour ce projet qui nécessite cependant quelques commandes pour fonctionner.
Tout d'abord, il faut s'assurer que la version de Python utilisée par défaut soit la version 3 :</p>
<div class="nuxt-content-highlight" data-v-1da88450 data-v-1da88450><pre class="line-numbers language-shell" data-v-1da88450 data-v-1da88450><code data-v-1da88450 data-v-1da88450><span class="token function" data-v-1da88450 data-v-1da88450>sudo</span> update-alternatives --install /usr/bin/python python /usr/bin/python3.7 <span class="token number" data-v-1da88450 data-v-1da88450>2</span>
</code></pre></div>
<p data-v-1da88450 data-v-1da88450>La commande <code data-v-1da88450 data-v-1da88450>python --version</code> doit maintenant vous renvoyer <code data-v-1da88450 data-v-1da88450>Python 3.7.x</code>. On va maintenant pouvoir installer les
dépendances :</p>
<div class="nuxt-content-highlight" data-v-1da88450 data-v-1da88450><pre class="line-numbers language-shell" data-v-1da88450 data-v-1da88450><code data-v-1da88450 data-v-1da88450><span class="token function" data-v-1da88450 data-v-1da88450>sudo</span> <span class="token function" data-v-1da88450 data-v-1da88450>usermod</span> -a -G spi,gpio pi
<span class="token function" data-v-1da88450 data-v-1da88450>sudo</span> <span class="token function" data-v-1da88450 data-v-1da88450>apt</span> <span class="token function" data-v-1da88450 data-v-1da88450>install</span> build-essential libfreetype6-dev libjpeg-dev libopenjp2-7 libtiff5
<span class="token function" data-v-1da88450 data-v-1da88450>sudo</span> pip3 <span class="token function" data-v-1da88450 data-v-1da88450>install</span> luma.led_matrix
<span class="token function" data-v-1da88450 data-v-1da88450>sudo</span> <span class="token function" data-v-1da88450 data-v-1da88450>apt</span> <span class="token function" data-v-1da88450 data-v-1da88450>install</span> libsdl-dev libportmidi-dev libsdl-ttf2.0-dev libsdl-mixer1.2-dev libsdl-image1.2-dev
<span class="token function" data-v-1da88450 data-v-1da88450>sudo</span> pip3 <span class="token function" data-v-1da88450 data-v-1da88450>install</span> pygame
<span class="token function" data-v-1da88450 data-v-1da88450>sudo</span> pip3 <span class="token function" data-v-1da88450 data-v-1da88450>install</span> luma.emulator
<span class="token function" data-v-1da88450 data-v-1da88450>sudo</span> pip3 <span class="token function" data-v-1da88450 data-v-1da88450>install</span> pynput
</code></pre></div>
<p data-v-1da88450 data-v-1da88450>(Il s'agit d'un condensé des informations d'installation de
<a href="https://luma-led-matrix.readthedocs.io/en/latest/install.html" rel="nofollow noopener noreferrer" target="_blank" data-v-1da88450 data-v-1da88450>Luma LED Matrix</a>,
<a href="https://luma-emulator.readthedocs.io/en/latest/install.html" rel="nofollow noopener noreferrer" target="_blank" data-v-1da88450 data-v-1da88450>Luma Emulator</a>, et
<a href="https://pypi.org/project/pynput/" rel="nofollow noopener noreferrer" target="_blank" data-v-1da88450 data-v-1da88450>Pynput</a>). Vous pouvez maintenant télécharger le script directement depuis Github :</p>
<div class="nuxt-content-highlight" data-v-1da88450 data-v-1da88450><pre class="line-numbers language-shell" data-v-1da88450 data-v-1da88450><code data-v-1da88450 data-v-1da88450><span class="token function" data-v-1da88450 data-v-1da88450>sudo</span> <span class="token function" data-v-1da88450 data-v-1da88450>apt</span> <span class="token function" data-v-1da88450 data-v-1da88450>install</span> <span class="token function" data-v-1da88450 data-v-1da88450>git</span>
<span class="token function" data-v-1da88450 data-v-1da88450>git</span> clone https://github.com/Skyost/Anaclock.git
</code></pre></div>
<p data-v-1da88450 data-v-1da88450>On va désactiver toutes les interactions possibles avec Raspberry Pi OS à la souris (pour éviter qu'un mauvais clic
vienne éteindre le système, voire pire). Pour cela, on va éditer le fichier <code data-v-1da88450 data-v-1da88450>~/.config/lxsession/LXDE-pi/autostart</code> à
l'aide de Nano :</p>
<div class="nuxt-content-highlight" data-v-1da88450 data-v-1da88450><pre class="line-numbers language-shell" data-v-1da88450 data-v-1da88450><code data-v-1da88450 data-v-1da88450><span class="token function" data-v-1da88450 data-v-1da88450>sudo</span> <span class="token function" data-v-1da88450 data-v-1da88450>nano</span> ~/.config/lxsession/LXDE-pi/autostart
</code></pre></div>
<p data-v-1da88450 data-v-1da88450>Cherchez la ligne commençant par <code data-v-1da88450 data-v-1da88450>@lxpanel</code> et éditez le fichier comme suit :</p>
<div class="nuxt-content-highlight" data-v-1da88450 data-v-1da88450><pre class="line-numbers language-shell" data-v-1da88450 data-v-1da88450><code data-v-1da88450 data-v-1da88450><span class="token comment" data-v-1da88450 data-v-1da88450># @lxpanel --profile LXDE-pi # Désactive lxpanel.</span>
<span class="token comment" data-v-1da88450 data-v-1da88450># @pcmanfm --desktop --profile LXDE-pi # Désactive PCManFM.</span>
<span class="token comment" data-v-1da88450 data-v-1da88450># @xscreensaver -no-splash # Désactive xscreensaver.</span>
@xset s off <span class="token comment" data-v-1da88450 data-v-1da88450># Désactive l’économiseur d’écran.</span>
@xset -dpms <span class="token comment" data-v-1da88450 data-v-1da88450># Désactive DPMS.</span>
@xset s noblank <span class="token comment" data-v-1da88450 data-v-1da88450># Empêche l'écran de devenir blanc.</span>
@point-rpi <span class="token comment" data-v-1da88450 data-v-1da88450># Positionne la souris sur le bouton du menu.</span>
</code></pre></div>
<p data-v-1da88450 data-v-1da88450>Faîtes <em data-v-1da88450 data-v-1da88450>CTRL + X</em> pour enregistrer le fichier, puis <em data-v-1da88450 data-v-1da88450>Y</em> pour valider. On va maintenant supprimer le menu contextuel
d'OpenBox. Éditez le fichier <code data-v-1da88450 data-v-1da88450>~/.config/openbox/lxde-pi-rc.xml</code> avec Nano :</p>
<div class="nuxt-content-highlight" data-v-1da88450 data-v-1da88450><pre class="line-numbers language-shell" data-v-1da88450 data-v-1da88450><code data-v-1da88450 data-v-1da88450><span class="token function" data-v-1da88450 data-v-1da88450>sudo</span> <span class="token function" data-v-1da88450 data-v-1da88450>nano</span> ~/.config/openbox/lxde-pi-rc.xml
</code></pre></div>
<p data-v-1da88450 data-v-1da88450>Et supprimez les lignes qui sont responsables du clic droit :</p>
<div class="nuxt-content-highlight" data-v-1da88450 data-v-1da88450><pre class="line-numbers language-xml" data-v-1da88450 data-v-1da88450><code data-v-1da88450 data-v-1da88450><span class="token comment" data-v-1da88450 data-v-1da88450>&lt;!-- Supprimez ou commentez ce qui se trouve entre cette balise... --></span>
<span class="token tag" data-v-1da88450 data-v-1da88450><span class="token tag" data-v-1da88450 data-v-1da88450><span class="token punctuation" data-v-1da88450 data-v-1da88450>&lt;</span>mousebind</span> <span class="token attr-name" data-v-1da88450 data-v-1da88450>button</span><span class="token attr-value" data-v-1da88450 data-v-1da88450><span class="token punctuation attr-equals" data-v-1da88450 data-v-1da88450>=</span><span class="token punctuation" data-v-1da88450 data-v-1da88450>"</span>Right<span class="token punctuation" data-v-1da88450 data-v-1da88450>"</span></span> <span class="token attr-name" data-v-1da88450 data-v-1da88450>action</span><span class="token attr-value" data-v-1da88450 data-v-1da88450><span class="token punctuation attr-equals" data-v-1da88450 data-v-1da88450>=</span><span class="token punctuation" data-v-1da88450 data-v-1da88450>"</span>Press<span class="token punctuation" data-v-1da88450 data-v-1da88450>"</span></span><span class="token punctuation" data-v-1da88450 data-v-1da88450>></span></span>
  <span class="token comment" data-v-1da88450 data-v-1da88450>&lt;!-- ... --></span>
<span class="token tag" data-v-1da88450 data-v-1da88450><span class="token tag" data-v-1da88450 data-v-1da88450><span class="token punctuation" data-v-1da88450 data-v-1da88450>&lt;/</span>mousebind</span><span class="token punctuation" data-v-1da88450 data-v-1da88450>></span></span> 
<span class="token comment" data-v-1da88450 data-v-1da88450>&lt;!-- ... Et cette balise. --></span>
</code></pre></div>
<p data-v-1da88450 data-v-1da88450>Au lieu de faire tout cela, une autre possibilité aurait été de lancer Chromium en mode kiosk au démarrage
(les étapes pour faire ceci sont disponibles <a href="https://gist.github.com/jongrover/6831346" rel="nofollow noopener noreferrer" target="_blank" data-v-1da88450 data-v-1da88450>ici</a>).
De même, faîtes <em data-v-1da88450 data-v-1da88450>CTRL + X</em> pour enregistrer le fichier, et validez avec <em data-v-1da88450 data-v-1da88450>Y</em>. On peut maintenant redémarrer le système
avec <code data-v-1da88450 data-v-1da88450>sudo reboot now</code>.</p>
<h2 id="faire-fonctionner-lhorloge" data-v-1da88450 data-v-1da88450>Faire fonctionner l'horloge<a href="#faire-fonctionner-lhorloge" aria-hidden="true" tabindex="-1" data-v-1da88450 data-v-1da88450><span class="anchor" data-v-1da88450 data-v-1da88450></span></a></h2>
<p data-v-1da88450 data-v-1da88450>Une fois le système redémarré, on se dirige dans le répertoire du script, et on l'exécute en fond :</p>
<div class="nuxt-content-highlight" data-v-1da88450 data-v-1da88450><pre class="line-numbers language-shell" data-v-1da88450 data-v-1da88450><code data-v-1da88450 data-v-1da88450><span class="token builtin class-name" data-v-1da88450 data-v-1da88450>cd</span> Anaclock
<span class="token builtin class-name" data-v-1da88450 data-v-1da88450>export</span> <span class="token assign-left variable" data-v-1da88450 data-v-1da88450><span class="token environment constant" data-v-1da88450 data-v-1da88450>DISPLAY</span></span><span class="token operator" data-v-1da88450 data-v-1da88450>=</span>:0.0
<span class="token function" data-v-1da88450 data-v-1da88450>nohup</span> python ./anaclock.py <span class="token operator" data-v-1da88450 data-v-1da88450>></span>/dev/null <span class="token operator" data-v-1da88450 data-v-1da88450><span class="token file-descriptor important" data-v-1da88450 data-v-1da88450>2</span>></span><span class="token file-descriptor important" data-v-1da88450 data-v-1da88450>&1</span> <span class="token operator" data-v-1da88450 data-v-1da88450>&</span>
</code></pre></div>
<p data-v-1da88450 data-v-1da88450>N'hésitez pas à mettre ceci dans un petit script qui se lance automatiquement, cela peut toujours faire gagner du temps.
Et voilà, normalement si vous bougez la souris en effectuant un mouvement sur le touchpad... La matrice de LEDs
devrait s'animer !</p>
<p data-v-1da88450 data-v-1da88450><img alt="Résultat" src="/images/articles/creer-horloge-matrice-leds/resultat.gif" data-v-1da88450 data-v-1da88450></p>
<p data-v-1da88450 data-v-1da88450>Voici les commandes programmées :</p>
<ul data-v-1da88450 data-v-1da88450>
<li data-v-1da88450 data-v-1da88450><strong data-v-1da88450 data-v-1da88450>Clic gauche / mouvement</strong> : affiche l'heure.</li>
<li data-v-1da88450 data-v-1da88450><strong data-v-1da88450 data-v-1da88450>Clic droit</strong> : affiche la date.</li>
<li data-v-1da88450 data-v-1da88450><strong data-v-1da88450 data-v-1da88450>Appui consécutif d'au moins 5 secondes sur le clic gauche</strong> : éteint l'appareil.</li>
</ul>
<p data-v-1da88450 data-v-1da88450>C'est terminé ! En espérant que ce petit projet vous ait plu, n'hésitez pas à m'envoyer vos retours 😉</p></div></article> <div class="red-box social-buttons mt-5 mb-5" data-v-5d69f4e0 data-v-25211e5c><span class="title" data-v-5d69f4e0>Partager l'article</span> <a href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fframboise-pi.skyost.eu%2Farticle%2Fcreer-horloge-matrice-leds&title=Cr%C3%A9er%20une%20horloge%20avec%20une%20matrice%20de%20LEDs&description=Premier%20projet%20%C3%A0%20voir%20le%20jour%20sur%20blog%20!%20Nous%20allons%20voir%20ici%20comment%20cr%C3%A9er%20une%20horloge%20abordable%0Aqui%20se%20d%C3%A9clenche%20au%20toucher%20%C3%A0%20l'aide%20d'un%20Raspberry%20Pi%2C%20d'un%20Touchpad%20et%20d'une%20matrice%20de%20LEDs.&hashtag=RaspberryPi" target="_blank" class="social-button facebook" data-v-bd07f6f6 data-v-25211e5c><span class="icon" data-v-bd07f6f6><svg aria-hidden="true" focusable="false" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" data-v-bd07f6f6><path fill="currentColor" d="m 375.14,288 14.22,-92.66 h -88.91 v -60.13 c 0,-25.35 12.42,-50.06 52.24,-50.06 h 40.42 V 6.26 C 393.11,6.26 356.43,0 321.36,0 248.14,0 200.28,44.38 200.28,124.72 v 70.62 H 118.89 V 288 h 81.39 V 512 H 300.45 V 288 Z" data-v-bd07f6f6></path></svg></span> <span class="name" data-v-bd07f6f6>Facebook</span></a><a href="https://twitter.com/intent/tweet?text=Cr%C3%A9er%20une%20horloge%20avec%20une%20matrice%20de%20LEDs&url=https%3A%2F%2Fframboise-pi.skyost.eu%2Farticle%2Fcreer-horloge-matrice-leds&hashtags=RaspberryPi" target="_blank" class="social-button twitter" data-v-bd07f6f6 data-v-25211e5c><span class="icon" data-v-bd07f6f6><svg aria-hidden="true" focusable="false" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" data-v-bd07f6f6><path fill="currentColor" d="M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z" data-v-bd07f6f6></path></svg></span> <span class="name" data-v-bd07f6f6>Twitter</span></a><a href="https://www.reddit.com/submit?url=https%3A%2F%2Fframboise-pi.skyost.eu%2Farticle%2Fcreer-horloge-matrice-leds&title=Cr%C3%A9er%20une%20horloge%20avec%20une%20matrice%20de%20LEDs" target="_blank" class="social-button reddit" data-v-bd07f6f6 data-v-25211e5c><span class="icon" data-v-bd07f6f6><svg aria-hidden="true" focusable="false" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" data-v-bd07f6f6><path fill="currentColor" d="M440.3 203.5c-15 0-28.2 6.2-37.9 15.9-35.7-24.7-83.8-40.6-137.1-42.3L293 52.3l88.2 19.8c0 21.6 17.6 39.2 39.2 39.2 22 0 39.7-18.1 39.7-39.7s-17.6-39.7-39.7-39.7c-15.4 0-28.7 9.3-35.3 22l-97.4-21.6c-4.9-1.3-9.7 2.2-11 7.1L246.3 177c-52.9 2.2-100.5 18.1-136.3 42.8-9.7-10.1-23.4-16.3-38.4-16.3-55.6 0-73.8 74.6-22.9 100.1-1.8 7.9-2.6 16.3-2.6 24.7 0 83.8 94.4 151.7 210.3 151.7 116.4 0 210.8-67.9 210.8-151.7 0-8.4-.9-17.2-3.1-25.1 49.9-25.6 31.5-99.7-23.8-99.7zM129.4 308.9c0-22 17.6-39.7 39.7-39.7 21.6 0 39.2 17.6 39.2 39.7 0 21.6-17.6 39.2-39.2 39.2-22 .1-39.7-17.6-39.7-39.2zm214.3 93.5c-36.4 36.4-139.1 36.4-175.5 0-4-3.5-4-9.7 0-13.7 3.5-3.5 9.7-3.5 13.2 0 27.8 28.5 120 29 149 0 3.5-3.5 9.7-3.5 13.2 0 4.1 4 4.1 10.2.1 13.7zm-.8-54.2c-21.6 0-39.2-17.6-39.2-39.2 0-22 17.6-39.7 39.2-39.7 22 0 39.7 17.6 39.7 39.7-.1 21.5-17.7 39.2-39.7 39.2z" data-v-bd07f6f6></path></svg></span> <span class="name" data-v-bd07f6f6>Reddit</span></a><a href="https://share.flipboard.com/bookmarklet/popout?v=2&url=https%3A%2F%2Fframboise-pi.skyost.eu%2Farticle%2Fcreer-horloge-matrice-leds&title=Cr%C3%A9er%20une%20horloge%20avec%20une%20matrice%20de%20LEDs" target="_blank" class="social-button flipboard" data-v-bd07f6f6 data-v-25211e5c><span class="icon" data-v-bd07f6f6><svg aria-hidden="true" focusable="false" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" data-v-bd07f6f6><path fill="currentColor" d="M 32,32 V 480 H 480 V 32 Z m 358.4,179.2 h -89.6 v 89.6 h -89.6 v 89.6 H 121.6 V 121.6 h 268.8 z" data-v-bd07f6f6></path></svg></span> <span class="name" data-v-bd07f6f6>Flipboard</span></a><a href="https://www.evernote.com/clip.action?url=https%3A%2F%2Fframboise-pi.skyost.eu%2Farticle%2Fcreer-horloge-matrice-leds&title=Cr%C3%A9er%20une%20horloge%20avec%20une%20matrice%20de%20LEDs" target="_blank" class="social-button evernote" data-v-bd07f6f6 data-v-25211e5c><span class="icon" data-v-bd07f6f6><svg aria-hidden="true" focusable="false" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" data-v-bd07f6f6><path fill="currentColor" d="m 184.82839,132.31764 c 1.6,22.31 -17.55,21.59 -21.61,21.59 -68.930001,0 -73.640001,-1 -83.580001,3.34 -0.56,0.22 -0.74,0 -0.37,-0.37 L 187.79839,46.557641 c 0.38,-0.37 0.6,-0.22 0.38,0.37 -4.35,9.99 -3.35,15.09 -3.35,85.389999 z m 79,308 c -14.68,-37.08 13,-76.93 52.52,-76.62 17.49,0 22.6,23.21 7.95,31.42 -6.19,3.3 -24.95,1.74 -25.14,19.2 -0.05,17.09 19.67,25 31.2,24.89 a 45.64,45.64 0 0 0 45.65,-45.65 v -0.08 c 0,-11.63 -7.79,-47.22 -47.54,-55.34 -7.72,-1.54 -65,-6.35 -68.35,-50.52 -3.74,16.93 -17.4,63.49 -43.11,69.09 -8.74,1.94 -69.68,7.64 -112.92,-36.77 0,0 -18.570001,-15.23 -28.230001,-57.95 -3.38,-15.75 -9.28,-39.7 -11.14,-62 0,-18 11.14,-30.45 25.07,-32.2 81.000001,0 90.000001,2.32 101.000001,-7.8 9.82,-9.24 7.8,-15.5 7.8,-102.779999 1,-8.3 7.79,-30.81 53.41,-24.14 6,0.86 31.91,4.18 37.48,30.64 l 64.26,11.15 c 20.43,3.71 70.94,7 80.6,57.939999 22.66,121.09 8.91,238.46 7.8,238.46 -15.98,114.38 -111.07,108.85 -111.07,108.85 -18.95,-0.23 -54.25,-9.4 -67.27,-39.83 z m 80.94,-204.84 c -1,1.92 -2.2,6 0.85,7 14.09,4.93 39.75,6.84 45.88,5.53 3.11,-0.25 3.05,-4.43 2.48,-6.65 -3.53,-21.85 -40.83,-26.5 -49.24,-5.92 z" data-v-bd07f6f6></path></svg></span> <span class="name" data-v-bd07f6f6>Evernote</span></a><a href="mailto:?subject=Cr%C3%A9er%20une%20horloge%20avec%20une%20matrice%20de%20LEDs&body=https%3A%2F%2Fframboise-pi.skyost.eu%2Farticle%2Fcreer-horloge-matrice-leds%0D%0APremier%20projet%20%C3%A0%20voir%20le%20jour%20sur%20blog%20!%20Nous%20allons%20voir%20ici%20comment%20cr%C3%A9er%20une%20horloge%20abordable%0Aqui%20se%20d%C3%A9clenche%20au%20toucher%20%C3%A0%20l'aide%20d'un%20Raspberry%20Pi%2C%20d'un%20Touchpad%20et%20d'une%20matrice%20de%20LEDs." target="_blank" class="social-button email" data-v-bd07f6f6 data-v-25211e5c><span class="icon" data-v-bd07f6f6><svg aria-hidden="true" focusable="false" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" data-v-bd07f6f6><path fill="currentColor" d="M502.3 190.8c3.9-3.1 9.7-.2 9.7 4.7V400c0 26.5-21.5 48-48 48H48c-26.5 0-48-21.5-48-48V195.6c0-5 5.7-7.8 9.7-4.7 22.4 17.4 52.1 39.5 154.1 113.6 21.1 15.4 56.7 47.8 92.2 47.6 35.7.3 72-32.8 92.3-47.6 102-74.1 131.6-96.3 154-113.7zM256 320c23.2.4 56.6-29.2 73.4-41.4 132.7-96.3 142.8-104.7 173.4-128.7 5.8-4.5 9.2-11.5 9.2-18.9v-19c0-26.5-21.5-48-48-48H48C21.5 64 0 85.5 0 112v19c0 7.4 3.4 14.3 9.2 18.9 30.6 23.9 40.7 32.4 173.4 128.7 16.8 12.2 50.2 41.8 73.4 41.4z" data-v-bd07f6f6></path></svg></span> <span class="name" data-v-bd07f6f6>Email</span></a></div> <div class="comments" data-v-11d2c600><script src="https://utteranc.es/client.js" repo="Skyost/FramboisePi" issue-term="pathname" label="comments" theme="boxy-light" crossorigin="anonymous" async data-v-11d2c600></script></div></div></div> <footer data-v-352c3246><img src="/_nuxt/img/raspberrypi.be93e73.svg" alt="Raspberry Pi" class="raspberrypi" data-v-352c3246>
  Copyright © 2021 - Hugo Delaunay <q data-v-352c3246>Skyost</q>.
  Tous droits réservés.
  <a href="#" data-v-352c3246>Mentions légales</a>.
  <!----></footer></div></div></div><script defer src="/_nuxt/static/1623191137/article/creer-horloge-matrice-leds/state.js"></script><script src="/_nuxt/af919af.js" defer></script><script src="/_nuxt/4d20806.js" defer></script><script src="/_nuxt/4b1a53f.js" defer></script><script src="/_nuxt/0a2b4e8.js" defer></script><script src="/_nuxt/f4f5e1e.js" defer></script>
  </body>
</html>
